#!/home/bin/python
# A. Cervoise - 2014-01-28

import sys
import subprocess

if len(sys.argv) == 3:
	for line in open(sys.argv[2],'r'):
		command = ['unace', 't', "-p" + line.rstrip(), sys.argv[1]]	
		p = subprocess.Popen(command, stdout=subprocess.PIPE, stderr=subprocess.STDOUT)
		text = p.communicate()[0]
		if len(text.split('CRC OK')) > 1:
			print line
			break
else:
        print "acecrack.py - v0.1"
        print "Dictionary attack against WinAce archives"
        print "The script needs unace (unace-nonfree on debian or http://www.winace.com/files/linunace25.tgz"
        print " "
        print "Usage: "
        print "acecrack.py archive.ace wordlist.txt"
