#include <File.au3>

$file = "url-list.txt"
$browserpath = "C:\Program Files (x86)\Mozilla Firefox\firefox.exe"

FileOpen($file, 0)
For $i = 1 to _FileCountLines($file)
     $line = FileReadLine($file, $i)
	Send("#r")

    ; Wait 10 seconds for the Run dialogue window to appear.
     WinWait("Run", "", 3)

    ; Simulate entering notepad.exe and pressing the 'ENTER' key.
    Send($browserpath & " " & $line &"{Enter}")

    ; Wait 10 seconds for the Notepad window to appear.
   WinWait("[CLASS:Mozilla Firefox]", "", 10)

   PrintScreen()
   Sleep(500)
   Send("{UP}{UP}{DOWN}{DOWN}{LEFT}{RIGHT}{LEFT}{RIGHT}{b}{a}")
   Sleep(500)
   PrintScreen()
   Sleep(500)
Next

FileClose($file)

MsgBox("Konami tester script ended.")

Func PrintScreen()
   ;you need to have PtrScr install, running and configure to automatically save the print screen (Save at desktop without asking)
   Send ("{PRINTSCREEN}")
   Sleep(5000)
   Send("{ENTER}")
   Sleep(5000)
EndFunc
